标题：一种基于安全大模型的EDR告警研判机器人
链接：http://xlab.tencent.com/cn/2024/01/26/edr-alert-analysis-robot/
类型：技术文章, 安全大模型, 告警分析, EDR
内容：Author Guannan Wang, Guancheng Li of Tencent Security Xuanwu Lab0x00 背景企业为防御网络攻击，常常投资于先进的安全产品，如EDR、NDR、WAF等，这些产品往往依靠特定的规则生成告警，提示企业可能存在的网络威胁。但这些告警规则因为缺乏网络安全领域的先验知识，为企业的安全防御带来了双重挑战：只依赖具体的规则进行检测会产生大量误报，导致企业难以分辨哪些是检测到真正网络威胁的告警；用户对告警的理解和反应受限于他们在安全领域的知识水平，这对用户的能力提出了较高的要求。因此，告警的解读和响应通常需要有丰富安全知识和经验的安全专家与企业的运营团队进行紧密合作才能完成。然而，不仅安全专家招聘成本高，依赖于人工分析的方法也存在效率低下等问题，难以应对告警数量激增的情况。此外，因为告警数据的敏感性，部分企业也担心上传云端等出网的分析方法带来的隐私泄露风险。因此，企业面临着在保障网络安全和把控成本效率之间寻找平衡的难题。为有效应对安全告警分析的挑战，我们引入了一款基于安全大模型的告警研判机器人，能够对EDR设备上报的告警进行智能分析。这款机器人融合了丰富的安全领域先验知识，能够对告警进行深入研判，自动执行调查和取证工作。我们的方案支持私有化部署，具备出色的专业分析能力并能保证极高的吞吐量，能够助力企业提升告警分析效率，同时降低相关成本。玄武实验室拥有专业的“攻防+AI”团队，多次助力腾讯在国家攻防演练中荣获前三名。实验室在ChatGPT发布之前就已经开始研究AI在安全领域的应用，并在ChatGPT推出后，进一步加深了对大模型相关技术的研究。
发布日期：2024-01-26T015031.365Z

标题：一种大模型端侧隐私保护方案
链接：http://xlab.tencent.com/cn/2023/12/05/hide_and_seek/
类型：技术文章, 大模型提示词隐私保护, 数据脱敏
内容：Author  Yu Chen(alohachen) of Tencent Security Xuanwu Lab0x00 简介随着LLM应用的广泛普及，用户对提示词中的隐私信息泄漏的担忧日益增加。我们首次提出了一种可部署在端侧的提示词隐私保护方案，并对其安全性和可用性进行了评估。与安全多方计算（MPC）和Presidio等方案相比，我们的方案具有轻量化、端到端，支持匿名信息还原等优点。
发布日期：2024-01-26T015031.365Z

标题：Windows Printer Spooler 远程代码执行漏洞 (CVE-2021-1675)
链接：http://xlab.tencent.com/cn/2021/06/21/xlab-21-001/
类型：advisories
内容：Windows打印机相关服务存在逻辑缺陷，可以被用来进行权限提升甚至可以实现远程任意代码执行，微软已于2021年6月8号发布安全补丁，对该缺陷进行修复，请尽快完成系统更新。
发布日期：2024-01-26T015031.369Z

标题：虚假的安全：五大Android厂商自带隐私保护应用脆弱性分析及漏洞利用
链接：http://xlab.tencent.com/cn/2021/05/14/A-Mirage-of-Safety-Bug-Finding-and-Exploit-Techniques-of-Top-Android-Vendors-Privacy-Protection-Apps/
类型：技术文章, Android, privacy
内容：Author Xiangqian Zhang, Huiming Liu of Tencent Security Xuanwu Lab0x00 简介本文我们将详细介绍对Android手机厂商自带的隐私保护应用程序的研究。我们调查了排名前五的Android供应商提供的隐私保护应用程序，发现许多应用程序并不能很好地保护我们的隐私安全。我们针对隐私保护应用提出了3种威胁模型，并展示了4个隐私保护应用的攻击案例。该研究已经发表在Black Hat Asia 2021。
发布日期：2024-01-26T015031.365Z

标题：Domain Borrowing 一种基于CDN的新型隐蔽通信方法
链接：http://xlab.tencent.com/cn/2021/05/14/domain-borrowing/
类型：Papers, CDN, C2
内容：作者：腾讯安全玄武实验室 dlive, salt0x00 背景简介CDN(Content Delivery Network) 是云服务厂商提供的一种Web内容加速分发服务。对于攻击者来说，CDN提供了大量分布于全球各地的边缘节点IP，并且可以将源服务器隐藏在CDN节点之后，所以CDN非常适合被用于保护C2的通信。本文介绍了我们在某些CDN实现中发现的一些特性，以及如何利用这些特性隐藏C2通信流量，我们将这种新型的基于CDN的隐蔽通信方法称为Domain Borrowing。
发布日期：2024-01-26T015031.365Z

标题：部分快速充电产品存在“BadPower”风险的安全提示
链接：http://xlab.tencent.com/cn/2020/07/16/badpower/
类型：技术文章
内容：问题简介腾讯安全玄武实验室在部分快速充电（以下简称快充）产品中发现了一种新型安全问题，并将其命名为“BadPower”。利用BadPower，攻击者可入侵支持快充技术的充电器等设备，使被入侵的设备在对外供电时输出过高电压，从而导致受电设备的元器件击穿、烧毁, 甚至可能进一步对受电设备所在物理环境产生安全隐患。
发布日期：2024-01-26T015031.365Z

标题：Apache Shiro 身份验证绕过漏洞 (CVE-2020-11989)
链接：http://xlab.tencent.com/cn/2020/06/30/xlab-20-002/
类型：advisories
内容：Apache Shiro是一个强大且易用的Java安全框架，它可以用来执行身份验证、授权、密码和会话管理。目前常见集成于各种应用中进行身份验证，授权等。漏洞详情腾讯安全玄武实验室研究员发现在Apache Shiro 1.5.3之前的版本，将Apache Shiro与Spring控制器一起使用时，特制请求可能会导致身份验证绕过。漏洞发现者该漏洞由腾讯安全玄武实验室的Ruilin发现并报告，此外来自边界无限的淚笑也独立向官方报告了此漏洞点。风险等级高风险漏洞风险身份验证绕过等影响版本Apache Shiro 1.5.3之前的版本
发布日期：2024-01-26T015031.369Z

标题：Apache Dubbo Provider 远程代码执行漏洞 (CVE-2020-1948)
链接：http://xlab.tencent.com/cn/2020/06/23/xlab-20-001/
类型：advisories
内容：Apache Dubbo是一种基于Java的高性能RPC框架。该项目于2011年开源，并于2018年2月进入Apache孵化器，目前已经成为了广大开发者最常使用的微服务框架之一。它提供了三大核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现。漏洞详情腾讯安全玄武实验室研究员发现，Dubbo 2.7.6或更低版本采用的默认反序列化方式存在代码执行漏洞，当Dubbo服务端暴露时(默认端口：20880)，攻击者可以发送未经验证的服务名或方法名的RPC请求，同时配合附加恶意的参数负载。当恶意参数被反序列化时，它将执行恶意代码。经验证该反序列化漏洞需要服务端存在可以被利用的第三方库，而研究发现极大多数开发者都会使用的某些第三方库存在能够利用的攻击链，攻击者可以利用它们直接对Dubbo服务端进行恶意代码执行，影响广泛。漏洞发现者Ruilin风险等级高风险漏洞风险远程代码执行等影响版本Apache Dubbo 2.7.0 ~ 2.7.6Apache Dubbo 2.6.0 ~ 2.6.7Apache Dubbo 2.5.x 所有版本 (官方不再提供支持)
发布日期：2024-01-26T015031.369Z

标题：深入分析Adobe忽略了6年的PDF漏洞
链接：http://xlab.tencent.com/cn/2019/09/12/deep-analysis-of-cve-2019-8014/
类型：技术文章, Bitmap, CVE-2013-2729, CVE-2019-8014, RLE, XFA
内容：本文详细分析了 Adobe Acrobat Reader / Pro DC 中近期修复的安全漏洞 CVE-2019-8014 。有趣的是，Adobe 在六年前修复了一个类似的漏洞 CVE-2013-2729 ，正是由于对该漏洞的修复不够完善，才使得 CVE-2019-8014 遗留了长达六年之久。本文同时讨论了如何为此类漏洞编写利用代码。本文作者：Ke Liu of Tencent Security Xuanwu Lab
发布日期：2024-01-26T015031.365Z

标题：Ghidra 从 XXE 到 RCE
链接：http://xlab.tencent.com/cn/2019/03/18/ghidra-from-xxe-to-rce/
类型：技术文章
内容：作者：腾讯安全玄武实验室 tomato, salt0x00 背景Ghidra是 NSA 发布的一款反汇编工具,它的发布引起了安全研究人员的极大兴趣。有研究人员发现Ghidra在加载工程时会存在XXE，基于笔者之前对XXE漏洞利用研究发现，攻击者可以利用Java中的特性以及Windows操作系统中NTLM认证协议的缺陷的组合来完成RCE。
发布日期：2024-01-26T015031.365Z

标题：全网筛查 WinRAR 代码执行漏洞 (CVE-2018-20250)
链接：http://xlab.tencent.com/cn/2019/02/22/investigating-winrar-code-execution-vulnerability-cve-2018-20250-at-internet-scale/
类型：技术文章
内容：作者：lywang, dannywei0x00 背景WinRAR 作为最流行的解压缩软件，支持多种压缩格式的压缩和解压缩功能。今天，Check Point公司的安全研究员 Nadav Grossman 公开了他在 WinRAR 中发现的一系列漏洞。其中以 ACE 解压缩模块的远程代码执行漏洞（CVE-2018-20250）最具危害力。WinRAR 为支持 ACE 压缩文件的解压缩功能，集成了一个具有 19 年历史的动态共享库 unacev2.dll。 而此共享库自 2006 年以来再未更新过，也未开启任何漏洞利用缓解技术。Nadav Grossman 在 unacev2.dll 中发现了一个目录穿越漏洞，成功利用此漏洞可导致远程代码执行或 Net-NTLM hash 泄露。
发布日期：2024-01-26T015031.369Z

标题：从一起“盗币”事件看以太坊存储 hash 碰撞问题
链接：http://xlab.tencent.com/cn/2018/11/09/pay-attention-to-the-ethereum-hash-collision-problem-from-the-stealing-coins-incident/
类型：技术文章, blockchain, ethereum
内容：Author  Kai Song(exp-sky)、hearmen、salt、sekaiwu of Tencent Security Xuanwu Lab“盗币”十一月六日，我们观察到以太坊上出现了这样一份合约，经调查发现是某区块链安全厂商发布的一份让大家来“盗币”的合约。
发布日期：2024-01-26T015031.369Z

标题：来自微信外挂的安全风险
链接：http://xlab.tencent.com/cn/2018/10/23/weixin-cheater-risks/
类型：技术文章, 微信外挂
内容：玄武实验室联合独立安全研究员 em 发现在 Mac OS 上用户量比较大的两款微信防撤回外挂存在安全问题，装了此外挂的用户只要在浏览器里访问攻击者页面并停留一分钟左右，攻击者即可拿到该用户的好友列表，聊天记录，甚至以该用户的身份给好友发送消息，对用户的信息安全造成巨大威胁。
发布日期：2024-01-26T015031.369Z

标题：利用恶意页面攻击本地Xdebug
链接：http://xlab.tencent.com/cn/2018/03/30/pwn-local-xdebug/
类型：技术文章, dns rebind, xdebug
内容：TL;DRPHP开发者以及一些安全研究人员经常会在本地搭建一个基于Xdebug的PHP的调试服务，在大部分配置情况下，Xdebug采用HTTP请求头中的X-Forwarded-For字段作为DBGp协议的回连地址。受害者浏览攻击页面一段时间，攻击者可利用DNS Rebind技术向本地服务器发送带有恶意X-Forwarded-For的请求，即有可能在受害者电脑上执行任意代码。
发布日期：2024-01-26T015031.369Z

标题：对华为HG532远程命令执行漏洞的新探索
链接：http://xlab.tencent.com/cn/2018/01/05/a-new-way-to-exploit-cve-2017-17215/
类型：技术文章, CVE-2017-17215, HG532
内容：2017年11月27日Check Point 公司报告了一个华为 HG532 系列路由器的远程命令执行漏洞，漏洞编号为CVE-2017-17215。利用该漏洞，向路由器UPnP服务监听的37215端口发送一个特殊构造的 HTTP 请求包，即可触发命令执行。此端口在默认配置下并不能从外网访问，但由于该系列路由器数量极其巨大，所以互联网上仍有较多可访问到该端口的设备存在。目前已经有蠕虫在利用这些暴露在互联网上的端口进行传播[1]。近期国内外已有不少对该漏洞原理的分析[2]，在此不再赘述。但我们发现该漏洞实际的威胁可能比目前大家所认为的更为严重，某些对该漏洞的防御建议也是不够的甚至错误的。37215端口暴露在互联网上的HG532系列设备只占其中很少一部分，就已经足够多到被蠕虫利用，而如果其它那些只在内网能访问到的37215端口也可以被攻击者利用呢？在2013年，国内爆发了一次家用路由器 DNS 劫持事件，利用的是WEB安全里的CSRF攻击技术。这种攻击技术能利用在现在HG532路由器的这个漏洞上吗？如果可以，那么只要诱使HG532路由器的用户用手机、电脑访问一个恶意页面，就可以导致路由器完全被攻击者控制。
发布日期：2024-01-26T015031.365Z

标题：Browser UI Security 技术白皮书
链接：http://xlab.tencent.com/cn/2017/10/16/browser-ui-security-whitepaper/
类型：技术文章
内容：Browser UI ,是指浏览器用户界面。浏览器经过几十年的发展，对于用户界面并没有一个统一的规定标准，目前大多数现代浏览器的用户界面包括：前进和后退按钮、刷新和停止加载按钮、地址栏、状态栏、页面显示窗口、查看源代码窗口、标签等。另外可能还会有一些其他的用户界面，例如下载管理、页面查找、通知、系统选项管理、隐身窗口等等。我们可以把Browser UI认为是一个前端标签式的页面管理器或者Web的外壳，用户不必去考虑浏览器应用程序底层是如何处理数据的，所有的网络行为结果，均由Browser UI去展现给用户。
发布日期：2024-01-26T015031.365Z

标题：从一个补了三次的漏洞看WCF的安全编程
链接：http://xlab.tencent.com/cn/2017/09/11/safe-coding-of-wcf-viewed-from-a-longlive-vulnerability/
类型：技术文章
内容：背景笔者在2016年11月发现并报告了HP Support Assistant (HPSA) 的权限提升漏洞，HP Product Security Response Team (HP PSRT) 响应迅速，但却以此漏洞可以通过软件的自动更新功能自动修复为由拒绝为其发布安全公告和CVE。4月份想起这件事后，笔者又分析了一遍修补后的HPSA，发现HP的开发人员在修补中犯了更为低级的错误，导致补丁可以被绕过重新实现权限提升。在随后与HP PSRT的沟通与合作中，再一次利用其它技巧绕过了其后续修补，最终笔者协助HP PSRT完成了漏洞的修补。本文将分析此漏洞的成因及多次补丁绕过，希望能以此为案例提高开发人员对安全的认识和理解，以减少由于对所用技术理解不到位和安全编程意识匮乏而导致的安全漏洞。
发布日期：2024-01-26T015031.369Z

标题：深入分析NSA用了5年的IIS漏洞
链接：http://xlab.tencent.com/cn/2017/04/18/nsa-iis-vulnerability-analysis/
类型：技术文章, CVE-2017-7269, Explodingcan, IIS, WebDAV
内容：Author Ke Liu of Tencent’s Xuanwu Lab1. 漏洞简介1.1 漏洞简介2017年3月27日，来自华南理工大学的 Zhiniang Peng 和 Chen Wu 在 GitHub [1] 上公开了一份 IIS 6.0 的漏洞利用代码，并指明其可能于 2016 年 7 月份或 8 月份被用于黑客攻击活动。该漏洞的编号为 CVE-2017-7269 [2]，由恶意的PROPFIND请求所引起：当If字段包含形如<http//localhost/xxxx>的超长URL时，可导致缓冲区溢出（包括栈溢出和堆溢出）。微软从 2015 年 7 月 14 日开始停止对 Windows Server 2003 的支持，所以这个漏洞也没有官方补丁，0patch [3] 提供了一个临时的解决方案。无独有偶，Shadow Brokers 在2017年4月14日公布了一批新的 NSA 黑客工具，笔者分析后确认其中的Explodingcan便是 CVE-2017-7269 的漏洞利用程序，而且两个 Exploit 的写法如出一辙，有理由认为两者出自同一团队之手：两个 Exploit 的结构基本一致；都将 Payload 数据填充到地址0x680312c0；都基于KiFastSystemCall / NtProtectVirtualMemory绕过 DEP；本文以 3 月份公布的 Exploit 为基础，详细分析该漏洞的基本原理和利用技巧。
发布日期：2024-01-26T015031.369Z

标题：用SQL注入穿IE沙箱
链接：http://xlab.tencent.com/cn/2017/01/19/ie-sandbox-escape-with-sql-injection/
类型：技术文章
内容：0x00 前言每一个安全初学者都喜欢问这样一个问题，“我应该做web安全还是做二进制安全，哪个更有意思？哪个更有钱途？”二进制安全就只等于反汇编，逆向，调试，内核 ……？Web安全就只等于XSS，SQL注入，CSRF，webshell ……？当两者结合起来的时候会发生什么美妙的事情呢？一个典型的Web系统运行于Linux平台，使用Apache作为服务器，用PHP完成功能逻辑，重要数据存储在MySQL数据中，接收用户输入并返回信息。对于客户端软件来说其实也存在类似的架构，软件运行在Windows系统上，用C/C++完成功能逻辑，可能用SQLite存储重要数据，支持进程间通信。那么在二进制漏洞挖掘中是否可用使用Web漏洞挖掘的思路呢？笔者在研究某客户端软件时发现了一个非常有意思的逻辑安全漏洞。本文笔者将展示如何使用客户端软件中存在的SQL注入漏洞，实现本地权限提升，使用漏洞可以绕过IE沙箱等的限制，在高权限进程的上下文中执行任意代码。
发布日期：2024-01-26T015031.369Z

标题：BadBookmarklet
链接：http://xlab.tencent.com/cn/2017/01/18/badbookmarklet/
类型：技术文章
内容：Bookmarklet，中文名可以翻译成小书签，它的存在形式和书签一样，都被保存在浏览器的收藏夹中。但它不是一个 HTTP、FTP、File 开头的 URL，而是一段 javascript 开头的 javascript 代码。1995 年 Javascript 的作者 Brendan Eich 特意设计 javascript URLs 和普通URL一样用于收藏夹，时至今日小书签已经于浏览器中存在了 20多年。在这些年中浏览器以及WEB 上的攻防对抗风云幻变，也使小书签上的安全风险渐渐大于它的业务实用性。从攻击的角度来看，日渐复杂的应用场景、多样化的攻击手段层出不穷，使小书签可以执行任意 javascript 代码的这个特性演变成一了种攻击手段。而在防御层面，CSP 的出现与普及，也似乎预示着小书签的历史使命走到了尽头。本文从在现代浏览器中导入和拖放小书签，来介绍小书签是如何变成一种致命攻击手段的。
发布日期：2024-01-26T015031.365Z

